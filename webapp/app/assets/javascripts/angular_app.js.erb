angular.module('app', [
      'app.services',
      'app.data',
      'app.directives',
      'app.filters',
      'app.controllers',
      'app.templates',
      'angular-flash.service', 'angular-flash.flash-alert-directive',
      'ui.bootstrap',
      'angulartics', 'angulartics.google.analytics',
      'ngRoute'
      ])
.config(['$routeProvider', '$locationProvider', '$httpProvider', function($routeProvider, $locationProvider, $httpProvider) {
  $routeProvider.
    //PICK UP HERE, FIGURE OUT ROUTES
      when('/', {redirectTo: function(){ return window.App.currentUser ? '/home' : '/external' }, reloadOnSearch: false}).
      when('/external', { redirectTo: function() { return _.find(App.sports, function(s) { return s.is_active; }).name + '/external' } }).
      when('/home', { redirectTo: function() { return _.find(App.sports, function(s) { return s.is_active; }).name + '/home' } }).
      when('/:sport/external', {templateUrl: '/sample_team.html', controller: 'HomeController'}).
      when('/:sport/home', {templateUrl: '/home.html', controller: 'HomeController'}).
      when('/:sport/playoffs', {templateUrl: '/home.html', controller: 'HomeController'}).
      when('/:sport/playoff_about', {templateUrl: '/playoff_about.html', controller: 'DummyController'}).
      when('/:sport/coming-soon', {templateUrl: '/coming_soon.html', controller: 'HomeController'}).
      when('/:sport/market/:market_id/roster/:roster_id', {templateUrl: '/roster.html', controller: 'RosterController'}).
      when('/:sport/market/:market_id/roster/:roster_id/vs/:opponent_roster_id', {templateUrl: '/roster.html', controller: 'RosterController'}).
      when('/:sport/market/:market_id', {templateUrl: '/home.html', controller: 'HomeController'}).
      when('/:sport/league/:league_id', {templateUrl: '/home.html', controller: 'HomeController'}).
      when('/:sport/rosters', {templateUrl: '/roster_list.html', controller: 'RosterListController'}).
      when('/:sport/history', {templateUrl: '/roster_list.html', controller: 'RosterHistoryController'}).
      when('/:sport/individual_predictions', {templateUrl: '/individual_prediction_list.html', controller: 'IndividualPredictionListController'}).
      when('/:sport/leaderboard', {templateUrl: '/leaderboard.html', controller: 'LeaderboardController'}).
      when('/:sport/rules', {templateUrl: '/rules.html', controller: 'RulesController'}).
      when('/terms', {templateUrl: '/support.html', controller: 'RulesController'}).
      when('/conditions', {templateUrl: '/conditions.html', controller: 'RulesController'}).
      when('/promos', {templateUrl: '/promos.html', controller: 'DummyController'}).
      when('/legal', {templateUrl: '/legal.html', controller: 'DummyController'}).
      when('/support', {templateUrl: '/support.html', controller: 'SupportController'}).
    //...
      otherwise({redirectTo: '/'});

    $httpProvider.defaults.useXDomain = true;
    delete $httpProvider.defaults.headers.common['X-Requested-With'];
  }]);
